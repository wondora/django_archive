{% for folder in folders %}
<div class="folder-tree-item">
    <div class="d-flex align-items-center py-1 drop-zone" data-folder-id="{{ folder.id }}">
        
        <span class="toggle-wrapper" style="width: 20px; display: inline-flex; justify-content: center;">
            {% if folder.subfolders.all %}
                <i class="bi bi-chevron-right toggle-icon" 
                   style="cursor: pointer; font-size: 0.75rem;" 
                   onclick="toggleSubfolders(event, 'sub-{{ folder.id }}')"></i>
            {% endif %}
        </span>

        <i class="bi bi-grip-vertical drag-handle me-1 text-secondary" 
           style="font-size: 0.9rem; cursor: grab;"
           draggable="true" 
           ondragstart="handleDragStart(event, 'folder', '{{ folder.id }}')"></i>
        
        <i class="bi bi-folder2 text-warning me-2"></i>

        <a href="{% url 'folder' folder.id %}" 
           class="text-decoration-none text-dark small folder-link {% if current_folder.id == folder.id %}fw-bold text-primary active-folder{% endif %}"
           draggable="false"
           style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"
           onclick="handleFolderClick(event, 'sub-{{ folder.id }}', {% if current_folder.id == folder.id %}true{% else %}false{% endif %})">
            {{ folder.name }}
        </a>
    </div>
    
    {% if folder.subfolders.all %}
        <div id="sub-{{ folder.id }}" class="subfolder-group" style="display: none; margin-left: 14px;">
            {% include "core/folder_tree.html" with folders=folder.subfolders.all %}
        </div>
    {% endif %}
</div>
{% endfor %}